<!DOCTYPE html>
<html lang="en">
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catalog-Z Bootstrap 5.0 HTML Template</title>
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/fontawesome/css/all.min.css">
    <link rel="stylesheet" href="/css/templatemo-style.css">
    <!--

    TemplateMo 556 Catalog-Z

    https://templatemo.com/tm-556-catalog-z

    -->

</head>
<body>


<!-- Page Loader -->
<div id="loader-wrapper">
    <div id="loader"></div>

    <div class="loader-section section-left"></div>
    <div class="loader-section section-right"></div>

</div>
<th:block layout:fragment="header" th:include="/fragments/header" ></th:block>

<div class="tm-hero d-flex justify-content-center align-items-center" data-parallax="scroll"
     data-image-src="img/hero.jpg">
    <form class="d-flex tm-search-form">
        <input class="form-control tm-search-input" type="search" id="imgSearch" placeholder="Search"
               aria-label="Search">
        <button class="btn btn-outline-success tm-search-btn" id="imgSearchBtn" type="submit">
            <i class="fas fa-search"></i>
        </button>
    </form>
</div>

<div class="container-fluid tm-container-content tm-mt-60">
    <div class="row mb-4">
        <h2 class="col-6 tm-text-primary">
            Latest Photos
        </h2>
        <div class="col-6 d-flex justify-content-end align-items-center">
            <form action="" class="tm-text-primary">
                Page <input type="text" value="1" size="1" class="tm-input-paging tm-text-primary"> of 200
            </form>
        </div>
    </div>
    <div class="row tm-mb-90 tm-gallery" id="gallery">
        <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 col-12 mb-5">
            <figure class="effect-ming tm-video-item">
                <img src="img/img-03.jpg" alt="Image" class="img-fluid">
                <figcaption class="d-flex align-items-center justify-content-center">
                    <h2>Clocks</h2>
                    <a href="photo-detail.html">View more</a>
                </figcaption>
            </figure>
            <div class="d-flex justify-content-between tm-text-gray">
                <span class="tm-text-gray-light">18 Oct 2020</span>
                <span>9,906 views</span>
            </div>
        </div>
        <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 col-12 mb-5">
            <figure class="effect-ming tm-video-item">
                <img src="img/img-04.jpg" alt="Image" class="img-fluid">
                <figcaption class="d-flex align-items-center justify-content-center">
                    <h2>Plants</h2>
                    <a href="photo-detail.html">View more</a>
                </figcaption>
            </figure>
            <div class="d-flex justify-content-between tm-text-gray">
                <span class="tm-text-gray-light">14 Oct 2020</span>
                <span>16,100 views</span>
            </div>
        </div>
        <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 col-12 mb-5">
            <figure class="effect-ming tm-video-item">
                <img src="img/img-05.jpg" alt="Image" class="img-fluid">
                <figcaption class="d-flex align-items-center justify-content-center">
                    <h2>Morning</h2>
                    <a href="photo-detail.html">View more</a>
                </figcaption>
            </figure>
            <div class="d-flex justify-content-between tm-text-gray">
                <span class="tm-text-gray-light">12 Oct 2020</span>
                <span>12,460 views</span>
            </div>
        </div>
        <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 col-12 mb-5">
            <figure class="effect-ming tm-video-item">
                <img src="img/img-06.jpg" alt="Image" class="img-fluid">
                <figcaption class="d-flex align-items-center justify-content-center">
                    <h2>Pinky</h2>
                    <a href="photo-detail.html">View more</a>
                </figcaption>
            </figure>
            <div class="d-flex justify-content-between tm-text-gray">
                <span class="tm-text-gray-light">10 Oct 2020</span>
                <span>11,402 views</span>
            </div>
        </div>

        <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 col-12 mb-5">
            <figure class="effect-ming tm-video-item">
                <img src="img/img-01.jpg" alt="Image" class="img-fluid">
                <figcaption class="d-flex align-items-center justify-content-center">
                    <h2>Hangers</h2>
                    <a href="photo-detail.html">View more</a>
                </figcaption>
            </figure>
            <div class="d-flex justify-content-between tm-text-gray">
                <span class="tm-text-gray-light">24 Sep 2020</span>
                <span>16,008 views</span>
            </div>
        </div>
        <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 col-12 mb-5">
            <figure class="effect-ming tm-video-item">
                <img src="img/img-02.jpg" alt="Image" class="img-fluid">
                <figcaption class="d-flex align-items-center justify-content-center">
                    <h2>Perfumes</h2>
                    <a href="photo-detail.html">View more</a>
                </figcaption>
            </figure>
            <div class="d-flex justify-content-between tm-text-gray">
                <span class="tm-text-gray-light">20 Sep 2020</span>
                <span>12,860 views</span>
            </div>
        </div>
        <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 col-12 mb-5">
            <figure class="effect-ming tm-video-item">
                <img src="img/img-07.jpg" alt="Image" class="img-fluid">
                <figcaption class="d-flex align-items-center justify-content-center">
                    <h2>Bus</h2>
                    <a href="photo-detail.html">View more</a>
                </figcaption>
            </figure>
            <div class="d-flex justify-content-between tm-text-gray">
                <span class="tm-text-gray-light">16 Sep 2020</span>
                <span>10,900 views</span>
            </div>
        </div>
        <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 col-12 mb-5">
            <figure class="effect-ming tm-video-item">
                <img src="img/img-08.jpg" alt="Image" class="img-fluid">
                <figcaption class="d-flex align-items-center justify-content-center">
                    <h2>New York</h2>
                    <a href="photo-detail.html">View more</a>
                </figcaption>
            </figure>
            <div class="d-flex justify-content-between tm-text-gray">
                <span class="tm-text-gray-light">12 Sep 2020</span>
                <span>11,300 views</span>
            </div>
        </div>
        <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 col-12 mb-5">
            <figure class="effect-ming tm-video-item">
                <img src="img/img-09.jpg" alt="Image" class="img-fluid">
                <figcaption class="d-flex align-items-center justify-content-center">
                    <h2>Abstract</h2>
                    <a href="photo-detail.html">View more</a>
                </figcaption>
            </figure>
            <div class="d-flex justify-content-between tm-text-gray">
                <span class="tm-text-gray-light">10 Sep 2020</span>
                <span>42,700 views</span>
            </div>
        </div>
        <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 col-12 mb-5">
            <figure class="effect-ming tm-video-item">
                <img src="img/img-10.jpg" alt="Image" class="img-fluid">
                <figcaption class="d-flex align-items-center justify-content-center">
                    <h2>Flowers</h2>
                    <a href="photo-detail.html">View more</a>
                </figcaption>
            </figure>
            <div class="d-flex justify-content-between tm-text-gray">
                <span class="tm-text-gray-light">8 Sep 2020</span>
                <span>11,402 views</span>
            </div>
        </div>
        <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 col-12 mb-5">
            <figure class="effect-ming tm-video-item">
                <img src="img/img-11.jpg" alt="Image" class="img-fluid">
                <figcaption class="d-flex align-items-center justify-content-center">
                    <h2>Rosy</h2>
                    <a href="photo-detail.html">View more</a>
                </figcaption>
            </figure>
            <div class="d-flex justify-content-between tm-text-gray">
                <span class="tm-text-gray-light">4 Sep 2020</span>
                <span>32,906 views</span>
            </div>
        </div>
        <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 col-12 mb-5">
            <figure class="effect-ming tm-video-item">
                <img src="img/img-12.jpg" alt="Image" class="img-fluid">
                <figcaption class="d-flex align-items-center justify-content-center">
                    <h2>Rocki</h2>
                    <a href="photo-detail.html">View more</a>
                </figcaption>
            </figure>
            <div class="d-flex justify-content-between tm-text-gray">
                <span class="tm-text-gray-light">28 Aug 2020</span>
                <span>50,700 views</span>
            </div>
        </div>
        <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 col-12 mb-5">
            <figure class="effect-ming tm-video-item">
                <img src="img/img-13.jpg" alt="Image" class="img-fluid">
                <figcaption class="d-flex align-items-center justify-content-center">
                    <h2>Purple</h2>
                    <a href="photo-detail.html">View more</a>
                </figcaption>
            </figure>
            <div class="d-flex justify-content-between tm-text-gray">
                <span class="tm-text-gray-light">22 Aug 2020</span>
                <span>107,510 views</span>
            </div>
        </div>
        <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 col-12 mb-5">
            <figure class="effect-ming tm-video-item">
                <img src="img/img-14.jpg" alt="Image" class="img-fluid">
                <figcaption class="d-flex align-items-center justify-content-center">
                    <h2>Sea</h2>
                    <a href="photo-detail.html">View more</a>
                </figcaption>
            </figure>
            <div class="d-flex justify-content-between tm-text-gray">
                <span class="tm-text-gray-light">14 Aug 2020</span>
                <span>118,006 views</span>
            </div>
        </div>
        <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 col-12 mb-5">
            <figure class="effect-ming tm-video-item">
                <img src="img/img-15.jpg" alt="Image" class="img-fluid">
                <figcaption class="d-flex align-items-center justify-content-center">
                    <h2>Turtle</h2>
                    <a href="photo-detail.html">View more</a>
                </figcaption>
            </figure>
            <div class="d-flex justify-content-between tm-text-gray">
                <span class="tm-text-gray-light">9 Aug 2020</span>
                <span>121,300 views</span>
            </div>
        </div>
        <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 col-12 mb-5">
            <figure class="effect-ming tm-video-item">
                <img src="img/img-16.jpg" alt="Image" class="img-fluid">
                <figcaption class="d-flex align-items-center justify-content-center">
                    <h2>Peace</h2>
                    <a href="photo-detail.html">View more</a>
                </figcaption>
            </figure>
            <div class="d-flex justify-content-between tm-text-gray">
                <span class="tm-text-gray-light">3 Aug 2020</span>
                <span>21,204 views</span>
            </div>
        </div>
    </div> <!-- row -->
    <div class="row tm-mb-90">
        <div class="col-12 d-flex justify-content-between align-items-center tm-paging-col">
            <a href="javascript:void(0);" class="btn btn-primary tm-btn-prev mb-2 disabled" id="prevPage">이전 페이지</a>
            <div class="tm-paging d-flex" id="paginationElement">
                <a href="javascript:void(0);" class="active tm-paging-link">1</a>
                <a href="javascript:void(0);" class="tm-paging-link">2</a>
                <a href="javascript:void(0);" class="tm-paging-link">3</a>
                <a href="javascript:void(0);" class="tm-paging-link">4</a>
            </div>
            <a href="javascript:void(0);" class="btn btn-primary tm-btn-next" id="nextPage">다음 페이지</a>
            <!--                <a href="javascript:void(0);" class="btn btn-primary tm-btn-next disabled" id="nextPageBlock">다음 페이지</a>-->


        </div>
    </div>
</div> <!-- container-fluid, tm-container-content -->

<footer class="tm-bg-gray pt-5 pb-3 tm-text-gray tm-footer">
    <div class="container-fluid tm-container-small">
        <div class="row">
            <div class="col-lg-6 col-md-12 col-12 px-5 mb-5">
                <h3 class="tm-text-primary mb-4 tm-footer-title">AIPictureWorld</h3>
                <p>AI Picture World에 오신 것을 환영합니다.</p>
            </div>
            <div class="col-lg-3 col-md-6 col-sm-6 col-12 px-5 mb-5">
                <h3 class="tm-text-primary mb-4 tm-footer-title">Our Links</h3>
                <ul class="tm-footer-links pl-0">
                    <li><a href="#">Advertise</a></li>
                    <li><a href="#">Support</a></li>
                    <li><a href="#">Our Company</a></li>
                    <li><a href="#">Contact</a></li>
                </ul>
            </div>
            <div class="col-lg-3 col-md-6 col-sm-6 col-12 px-5 mb-5">
                <ul class="tm-social-links d-flex justify-content-end pl-0 mb-5">
                    <li class="mb-2"><a href="https://facebook.com"><i class="fab fa-facebook"></i></a></li>
                    <li class="mb-2"><a href="https://twitter.com"><i class="fab fa-twitter"></i></a></li>
                    <li class="mb-2"><a href="https://instagram.com"><i class="fab fa-instagram"></i></a></li>
                    <li class="mb-2"><a href="https://pinterest.com"><i class="fab fa-pinterest"></i></a></li>
                </ul>
                <a href="#" class="tm-text-gray text-right d-block mb-2">Terms of Use</a>
                <a href="#" class="tm-text-gray text-right d-block">Privacy Policy</a>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-8 col-md-7 col-12 px-5 mb-3">
                Copyright 2020 Catalog-Z Company. All rights reserved.
            </div>
            <div class="col-lg-4 col-md-5 col-12 px-5 text-right">
                Designed by <a href="https://templatemo.com" class="tm-text-gray" rel="sponsored" target="_parent">TemplateMo</a>
            </div>
        </div>
    </div>
</footer>

<script src="js/plugins.js"></script>
<script>
    $(window).on("load", function () {
        $('body').addClass('loaded');
    });
</script>


<script type="text/javascript">

    console.log("test");
    let paging = document.querySelector("#imgSearchBtn");
    if (sessionStorage.getItem('pageNum') == null) {
        sessionStorage.setItem('pageNum', '1');
    }

    paging.addEventListener("click", function (event) {
        event.preventDefault();
        let imgSearch = document.getElementById("imgSearch");
        console.log(imgSearch.value);

        let pageNum = parseInt(sessionStorage.getItem('pageNum')) - 1;

        getImgBoardPaging(imgSearch.value, pageNum, "boardNm,ASC");
    });

    document.addEventListener("DOMContentLoaded", function () {

        let imgSearch = document.getElementById("imgSearch");

        let pageNum = parseInt(sessionStorage.getItem('pageNum')) - 1;


        console.log("pageNum : " + pageNum);


        const actPage = parseInt(sessionStorage.getItem('pageNum'));
        let startPage = parseInt(sessionStorage.getItem('pageNum')) - 2;
        if (startPage > 1) {
            startPage = startPage - 2;
        } else {
            startPage = 1;
        }
        let endPage = parseInt(sessionStorage.getItem('pageNum')) + 2;

        createPagination(startPage, endPage, actPage);

        getImgBoardPaging(imgSearch.value, pageNum, "boardNm,ASC");

    });

    function getPhotoData() {


        $.ajax({
            url: "/getImgBoardData",
            type: 'GET',
            success: function (data) {
                console.log("이미지를 가져왔습니다.");
                console.log(data);
                console.log(data.length);
                console.log(data[0]);
                let ulNode = document.getElementById("gallery");
                let imgText = "";
                for (let i = 0; i < data.length; i++) {
                    imgText +=
                        "<div class=\"col-xl-3 col-lg-4 col-md-6 col-sm-6 col-12 mb-5\">\n" +
                        "                <figure class=\"effect-ming tm-video-item\">\n" +
                        "                    <img src=\"img/img-03.jpg\" alt=\"Image\" class=\"img-fluid\">\n" +
                        "                    <figcaption class=\"d-flex align-items-center justify-content-center\">\n" +
                        "                        <h2>" + data[i].boardNm + "</h2>\n" +
                        "                        <a href=\"photo-detail.html\">View more</a>\n" +
                        "                    </figcaption>                    \n" +
                        "                </figure>\n" +
                        "                <div class=\"d-flex justify-content-between tm-text-gray\">\n" +
                        "                    <span class=\"tm-text-gray-light\">" + data[i].createDt + "</span>\n" +
                        "                    <span>" + data[i].views + " views</span>\n" +
                        "                </div>\n" +
                        "            </div>";
                }
                ulNode.innerHTML = imgText;
            },

            error: function () {
                alert("이미지를 가져오는데 문제가 발생하였습니다.");
            }
        })

    }

    //페이징 적용된 이미지 불러오기
    function getImgBoardPaging(searchVal, page, sort) {


        console.log(page, sort);
        let data = "test";
        let size = 8;

        let imgBoardDto = {
            boardNm: searchVal
        }
        $.ajax({
            //url:"/paging?page=3&size=5&sort=boardNo,ASC",
            // url:"/paging?boardNm=zz&page="+ page +"&size="+ size +"&sort="+ sort,
            url: "/search?page=" + page + "&size=" + size + "&sort=" + sort,
            data: imgBoardDto,
            type: 'GET',
            success: function (data) {
                console.log("페이징 데이터를 가져왔습니다.");
                console.log(data);
                console.log("length : " + data.content.length);
                //console.log(data.content[0].boardNo);

                let ulNode = document.getElementById("gallery");
                let imgText = "";
                for (let i = 0; i < data.content.length; i++) {
                    console.log("i : " + i);
                    imgText +=
                        "<div class=\"col-xl-3 col-lg-4 col-md-6 col-sm-6 col-12 mb-5\">\n" +
                        "                <figure class=\"effect-ming tm-video-item\">\n" +
                        "                    <img src=" + data.content[i][5] + data.content[i][6] + " alt=\"Image\" class=\"img-fluid\">\n" +
                        "                    <figcaption class=\"d-flex align-items-center justify-content-center\">\n" +
                        "                        <h2>" + data.content[i][1] + "</h2>\n" +
                        "                        <a href=\'photoDetail?boardNo=" + data.content[i][0] + "'\>View more</a>\n" +
                        "                    </figcaption>                    \n" +
                        "                </figure>\n" +
                        "                <div class=\"d-flex justify-content-between tm-text-gray\">\n" +
                        "                    <span>" + data.content[i][3] + " views</span>\n" +
                        "                    <span class=\"tm-text-gray-light\">" + data.content[i][4] + "</span>\n" +
                        "                </div>\n" +
                        "            </div>";
                }
                ulNode.innerHTML = imgText;

                createPagination(1, data.totalPages, data.pageable.pageNumber);
            },


            error: function () {
                alert("이미지를 가져오는데 문제가 발생하였습니다.");
            }
        })

    }

    function createPagination(start, end, activePage) {

        const paginationElement = document.getElementById("paginationElement");

        paginationElement.innerHTML = '';

        //if(start )

        for (let i = 0; i < end; i++) {
            const pageLink = document.createElement("a");
            pageLink.textContent = i + 1;
            pageLink.classList.add("page-number", "tm-paging-link");
            pageLink.href = "javascript:getImgBoardPaging(''," + i + ",'ASC')";
            if (i === activePage) {
                pageLink.classList.add("active");
            }
            paginationElement.appendChild(pageLink);
        }

        let prevPage = document.getElementById("prevPage");
        if (0 === activePage) {
            prevPage.classList.add("disabled");
        } else {
            prevPage.classList.remove("disabled");
        }

        console.log("end : " + end);
        console.log("act : " + activePage);
        let nextPage = document.getElementById("nextPage");

        if (end - 1 === activePage) {
            nextPage.classList.add("disabled");
        } else {
            nextPage.classList.remove("disabled");
        }
    }

</script>
</body>
</html>