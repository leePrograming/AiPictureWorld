<!DOCTYPE html>
<html lang="en">
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catalog-Z Photo Detail Page</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="fontawesome/css/all.min.css">
    <link rel="stylesheet" href="css/templatemo-style.css">
    <link rel="stylesheet" href="css/main.css">
<!--
    
TemplateMo 556 Catalog-Z

https://templatemo.com/tm-556-catalog-z

-->
</head>
<body>
    <!-- Page Loader -->
    <div id="loader-wrapper">
        <div id="loader"></div>

        <div class="loader-section section-left"></div>
        <div class="loader-section section-right"></div>

    </div>
    <th:block layout:fragment="header" th:include="/fragments/header.html"></th:block>

    <div class="tm-hero d-flex justify-content-center align-items-center" data-parallax="scroll" data-image-src="img/hero.jpg">
        <form class="d-flex tm-search-form">
            <input class="form-control tm-search-input" type="search" placeholder="Search" aria-label="Search">
            <button class="btn btn-outline-success tm-search-btn" type="submit">
                <i class="fas fa-search"></i>
            </button>
        </form>
    </div>

    <div class="container-fluid tm-container-content tm-mt-60">
        <div class="row mb-4">
            <h2 class="col-12 tm-text-primary">Photo title goes here</h2>
        </div>
        <div class="row tm-mb-90">            
            <div class="col-xl-8 col-lg-7 col-md-6 col-sm-12">
                <img th:src="${attachFile.getLocalPath()+attachFile.getRealFileNm()}" width="100%" height="100%" alt="Image" class="img-fluid">
            </div>
            <div class="col-xl-4 col-lg-5 col-md-6 col-sm-12">
                <div class="tm-bg-gray tm-video-details">
                    <p class="mb-4">
                        현재 이미지를 다운받고 싶다면 다운로드를 클릭해주세요.
                    </p>
                    <div class="text-center mb-5">
<!--                        <a th:href="@{/downLoad?fileId=${attatchFile.}}" class="btn btn-primary tm-btn-big">Download</a>-->
                        <a href="/download/img-02.jpg" class="btn btn-primary tm-btn-big">Download</a>
                    </div>
                    <div class="mb-4 d-flex flex-wrap">
                        <div class="mr-4 mb-2">
                            <span class="tm-text-gray-dark">Dimension: </span><span class="tm-text-primary" th:text="${photoDetail.getDimension()}">test</span>
                        </div>
                        <div class="mr-4 mb-2">
                            <span class="tm-text-gray-dark">Format: </span><span class="tm-text-primary" th:text="${photoDetail.getFormat()}"></span>
                        </div>
                    </div>
                    <div class="mb-4">
                        <h3 class="tm-text-gray-dark mb-3">License</h3>
                        <p>개인용과 상업용 모두 무료입니다. 아무것도 지불할 필요가 없습니다. 속성을 지정할 필요가 없습니다.</p>
                    </div>
                    <div>
                        <h3 class="tm-text-gray-dark mb-3">태그</h3>
                        <div id="tagList"></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row mb-4">
            <h2 class="col-12 tm-text-primary">
                Related Photos
            </h2>
        </div>
        <div class="row mb-3 tm-gallery" id="relatedPhotos">
            <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 col-12 mb-5">
                <figure class="effect-ming tm-video-item">
                    <img src="img/img-01.jpg" alt="Image" class="img-fluid">
                    <figcaption class="d-flex align-items-center justify-content-center">
                        <h2>Hangers</h2>
                        <a href="#">View more</a>
                    </figcaption>                    
                </figure>
                <div class="d-flex justify-content-between tm-text-gray">
                    <span class="tm-text-gray-light">16 Oct 2020</span>
                    <span>12,460 views</span>
                </div>
            </div>
            <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 col-12 mb-5">
                <figure class="effect-ming tm-video-item">
                    <img src="img/img-02.jpg" alt="Image" class="img-fluid">
                    <figcaption class="d-flex align-items-center justify-content-center">
                        <h2>Perfumes</h2>
                        <a href="#">View more</a>
                    </figcaption>                    
                </figure>
                <div class="d-flex justify-content-between tm-text-gray">
                    <span class="tm-text-gray-light">12 Oct 2020</span>
                    <span>11,402 views</span>
                </div>
            </div>
            <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 col-12 mb-5">
                <figure class="effect-ming tm-video-item">
                    <img src="img/img-03.jpg" alt="Image" class="img-fluid">
                    <figcaption class="d-flex align-items-center justify-content-center">
                        <h2>Clocks</h2>
                        <a href="#">View more</a>
                    </figcaption>                    
                </figure>
                <div class="d-flex justify-content-between tm-text-gray">
                    <span class="tm-text-gray-light">8 Oct 2020</span>
                    <span>9,906 views</span>
                </div>
            </div>
            <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 col-12 mb-5">
                <figure class="effect-ming tm-video-item">
                    <img src="img/img-04.jpg" alt="Image" class="img-fluid">
                    <figcaption class="d-flex align-items-center justify-content-center">
                        <h2>Plants</h2>
                        <a href="#">View more</a>
                    </figcaption>                    
                </figure>
                <div class="d-flex justify-content-between tm-text-gray">
                    <span class="tm-text-gray-light">6 Oct 2020</span>
                    <span>16,100 views</span>
                </div>
            </div>
            <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 col-12 mb-5">
                <figure class="effect-ming tm-video-item">
                    <img src="img/img-05.jpg" alt="Image" class="img-fluid">
                    <figcaption class="d-flex align-items-center justify-content-center">
                        <h2>Morning</h2>
                        <a href="#">View more</a>
                    </figcaption>                    
                </figure>
                <div class="d-flex justify-content-between tm-text-gray">
                    <span class="tm-text-gray-light">26 Sep 2020</span>
                    <span>16,008 views</span>
                </div>
            </div>
            <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 col-12 mb-5">
                <figure class="effect-ming tm-video-item">
                    <img src="img/img-06.jpg" alt="Image" class="img-fluid">
                    <figcaption class="d-flex align-items-center justify-content-center">
                        <h2>Pinky</h2>
                        <a href="#">View more</a>
                    </figcaption>                    
                </figure>
                <div class="d-flex justify-content-between tm-text-gray">
                    <span class="tm-text-gray-light">22 Sep 2020</span>
                    <span>12,860 views</span>
                </div>
            </div>
            <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 col-12 mb-5">
                <figure class="effect-ming tm-video-item">
                    <img src="img/img-07.jpg" alt="Image" class="img-fluid">
                    <figcaption class="d-flex align-items-center justify-content-center">
                        <h2>Bus</h2>
                        <a href="#">View more</a>
                    </figcaption>                    
                </figure>
                <div class="d-flex justify-content-between tm-text-gray">
                    <span class="tm-text-gray-light">12 Sep 2020</span>
                    <span>10,900 views</span>
                </div>
            </div>
            <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 col-12 mb-5">
                <figure class="effect-ming tm-video-item">
                    <img src="img/img-08.jpg" alt="Image" class="img-fluid">
                    <figcaption class="d-flex align-items-center justify-content-center">
                        <h2>New York</h2>
                        <a href="#">View more</a>
                    </figcaption>                    
                </figure>
                <div class="d-flex justify-content-between tm-text-gray">
                    <span class="tm-text-gray-light">4 Sep 2020</span>
                    <span>11,300 views</span>
                </div>
            </div>        
        </div> <!-- row -->
    </div> <!-- container-fluid, tm-container-content -->

    <th:block layout:pragment="footer" th:include="fragments/footer.html"></th:block>
    
    <script src="/js/plugins.js"></script>

    <script th:inline="javascript">
        //let test= [[${photoDetail.getFormat()}]];
        //console.log("test : " + test);
        //getRelatedPhotoData([[${photoDetail.getFormat()}]]);

    </script>

    <script th:inline="javascript">
        $(window).on("load", function() {
            $('body').addClass('loaded');
        });

        document.addEventListener("DOMContentLoaded", function(){
            let val = [[${photoDetail.getBoardNo()}]];
            console.log("val : " + val);
            splitPhotoTag();

            getRelatedPhotoData(val);
        });

        function splitPhotoTag(){

            let tag = [[${photoDetail.getTag()}]];
            let splitData= tag.split(",");
            let tagList = document.getElementById("tagList");
            let tagText = "";

            console.log(splitData);

            for(let i=0; i<splitData.length; i++){

                tagText += "<button type='button' class='btn btn-round'><a href='#' class='mr-4 mb-2 text-center d-inline-block'>"+ splitData[i] +"</a></button>";
            }

            tagList.innerHTML = tagText;


        }

        function getRelatedPhotoData(val){

            let searchVal = val;

            let imgBoardDto = {
                boardNo:searchVal
            }

            $.ajax({
                url:"/searchRelate",
                data:imgBoardDto,
                type:'GET',
                success:function(data){
                    console.log("이미지를 가져왔습니다.");
                    console.log(data);
                    console.log(data.length);
                    console.log(data[0]);
                    let ulNode = document.getElementById("relatedPhotos");
                    let imgText = "";
                    for(let i=0; i<data.length; i++) {
                        imgText +=
                            "<div class=\"col-xl-3 col-lg-4 col-md-6 col-sm-6 col-12 mb-5\">\n" +
                            "                <figure class=\"effect-ming tm-video-item\">\n" +
                            "                    <img src=\"img/img-03.jpg\" alt=\"Image\" class=\"img-fluid\">\n" +
                            "                    <figcaption class=\"d-flex align-items-center justify-content-center\">\n" +
                            "                        <h2>" + data[i].boardNm + "</h2>\n" +
                            "                        <a href=\"photo-detail.html\">View more</a>\n" +
                            "                    </figcaption>                    \n" +
                            "                </figure>\n" +
                            "                <div class=\"d-flex justify-content-between tm-text-gray\">\n" +
                            "                    <span class=\"tm-text-gray-light\">" + data[i].createDt + "</span>\n" +
                            "                    <span>" + data[i].views + " views</span>\n" +
                            "                </div>\n" +
                            "            </div>";
                    }
                    ulNode.innerHTML = imgText;
                },

                error:function(){
                    alert("이미지를 가져오는데 문제가 발생하였습니다.");
                }
            })

        }



    </script>
</body>
</html>